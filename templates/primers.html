{% extends 'base.html' %}

{% block content %}
<!-- Additional styles for the table -->
<style>
    #primerListTable, #primerListTable thead, #primerListTable tbody, #primerListTable tfoot, #primerListTable tr, #primerListTable th, #primerListTable td {
        border: none !important;
        border-collapse: collapse;
    }

    #primerListTable .group {
        font-weight: bold;
        text-decoration: underline;
    }

    /* Remove hover effect */
    #primerListTable tr:hover {
        background-color: inherit !important;
    }

    /* Set all rows to white background */
    #primerListTable tr {
        background-color: white !important;
    }

    /* Remove any outer borders or shadows from the menu list container */
    .menu-list {
        border: none !important;
        box-shadow: none !important;
    }

    /* Remove border introduced by DataTables scroll feature */
    .dataTables_scroll {
        border: none !important;
    }

    /* Style for selected rows */
    tr.selected {
        background-color: hsl(204, 86%, 53%) !important;
    }

    #primerListTable {
        user-select: none;      /* Standard syntax */
        -webkit-user-select: none; /* Chrome and Safari */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none;  /* Internet Explorer/Edge */
    }
    #primerListTable.table tbody tr.selected {
    background-color: hsl(204, 86%, 53%) !important;
    }



        /* Style for the sidebars */
    .sidebar {
        width: 20%; /* Reduziert auf 20% für eine schmalere Sidebar */
        float: left;
        padding: 1em 2em 1em 0; /* Fügt rechten Padding hinzu, um Abstand zwischen den Sidebars zu erhöhen */
    }


</style>

<!-- Original Sidebar (Primer Lists) -->
<div class="sidebar">
    <aside class="menu">
        <p class="menu-label">
            Primer Lists
        </p>
        <ul class="menu-list">
            <!-- Using DataTables to display the primer list -->
            <table id="primerListTable" class="table is-fullwidth">
                <tbody>
                    {% for primer_list in primer_lists %}
                        {% if primer_list.visibility == 'public' or (primer_list.visibility == 'private' and primer_list.user_id == current_user.id) %}
                            <tr>
                                <td>{{ primer_list.name }}</td>
                                <td>{{ primer_list.visibility }}</td>
                            </tr>
                        {% endif %}
                    {% endfor %}
                </tbody>
            </table>
        </ul>
    </aside>
</div>

<!-- New Sidebar (For new DataTable) -->
<div class="sidebar">
    <aside class="menu">
        <p class="menu-label">
            New Table
        </p>
        <ul class="menu-list">
            <!-- Using DataTables for the new table -->
            <table id="newTable" class="table is-fullwidth">
                <thead>
                    <tr>
                        <th>Name</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Primer 1</td>
                    </tr>
                    <!-- Add more rows as needed -->
                </tbody>
            </table>
        </ul>
    </aside>
</div>

<!-- Placeholder for additional content, if needed -->
<div class="content" style="clear: both;">
    <!-- Any additional content can go here -->
</div>
{% endblock %}

{% block scripts %}
<script>
    var groupColumn = 1;  // This should be 1 for the Visibility column, since columns are 0-indexed
    var table = $('#primerListTable').DataTable({
        columnDefs: [{ visible: false, targets: groupColumn }],
        order: [[groupColumn, 'asc']],
        paging: false,
        searching: false,
        bInfo: false,
        ordering: false,
        scrollCollapse: true,
        scrollY: '50vh',
        drawCallback: function (settings) {
            var api = this.api();
            var rows = api.rows({ page: 'current' }).nodes();
            var last = null;

            api.column(groupColumn, { page: 'current' })
                .data()
                .each(function (group, i) {
                    if (last !== group) {
                        $(rows)
                            .eq(i)
                            .before(
                                '<tr class="group"><td colspan="2">' +
                                    group +
                                    '</td></tr>'
                            );

                        last = group;
                    }
                });
        }
    });

    // Click event listener for row selection, excluding group rows
    $('#primerListTable tbody').on('click', 'tr:not(.group)', function() {
        console.log("Row clicked!");

        if ($(this).hasClass('selected')) {
            $(this).removeClass('selected');
        } else {
            $('#primerListTable tbody tr.selected').removeClass('selected');
            $(this).addClass('selected');
        }
    });

    // Initialize the new DataTable
    $('#newTable').DataTable({
        paging: false,
        searching: false,
        bInfo: false,
        ordering: false,
        scrollCollapse: true,
        scrollY: '50vh'
    });
</script>
{% endblock %}